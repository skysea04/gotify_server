(this["webpackJsonpgotify-ui"]=this["webpackJsonpgotify-ui"]||[]).push([[0],{421:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(20),c=(n(249),n(19)),s=n.n(c),o=n(25),l=Object(o.a)({url:"unset",register:!1,version:{commit:"unknown",buildDate:"unknown",version:"unknown"}},window.config);function u(e){return l[e]}var d,h=n(8),j=n(10),b=n(15),p=n(17),f=n(14),O=n(13),m=n(9),g=(n(38),n(35)),x=n(231),v=n(489),y=n(6),w=n(490),k=n(30),C=n(47),S=n(91),I=n(463),N=n(469),D=n(468),A=n(494),M=n(467),B=n(82),T=n(212),z=n.n(T),E=n(209),W=n.n(E),U=n(210),P=n.n(U),_=n(213),q=n.n(_),L=n(205),F=n.n(L),R=n(206),H=n.n(R),K=n(207),V=n.n(K),Y=n(211),G=n.n(Y),X=n(208),J=n.n(X),Q=n(24),Z=n(492),$=n(495),ee=n(1),te=["width","icon","label"],ne=Object(Q.c)(d=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.version,a=e.name,r=e.loggedIn,i=e.admin,c=e.toggleTheme,s=e.logout,o=e.style,l=e.setNavOpen,u=e.width,d="xs"===u?"sticky":"fixed";return Object(ee.jsx)(I.a,{position:d,style:o,className:t.appBar,children:Object(ee.jsxs)(M.a,{className:t.toolbar,children:[Object(ee.jsxs)("div",{className:t.title,children:[Object(ee.jsx)(C.b,{to:"/",className:t.link,children:Object(ee.jsx)(B.a,{variant:"h5",className:t.titleName,color:"inherit",children:"Gotify"})}),Object(ee.jsx)("a",{href:"https://github.com/gotify/server/releases/tag/v"+n,className:t.link,children:Object(ee.jsxs)(B.a,{variant:"button",color:"inherit",children:["@",n]})})]}),r&&this.renderButtons(a,i,s,u,l),Object(ee.jsxs)("div",{children:[Object(ee.jsx)(D.a,{onClick:c,color:"inherit",children:Object(ee.jsx)(F.a,{})}),Object(ee.jsx)("a",{href:"https://github.com/gotify/server",className:t.link,target:"_blank",rel:"noopener noreferrer",children:Object(ee.jsx)(D.a,{color:"inherit",children:Object(ee.jsx)(H.a,{})})})]})]})})}},{key:"renderButtons",value:function(e,t,n,a,r){var i=this.props,c=i.classes,s=i.showSettings;return Object(ee.jsxs)("div",{className:c.menuButtons,children:[Object(ee.jsx)(Z.a,{smUp:!0,implementation:"css",children:Object(ee.jsx)(ae,{icon:Object(ee.jsx)(V.a,{}),onClick:function(){return r(!0)},label:"menu",width:a,color:"inherit"})}),t&&Object(ee.jsx)(C.b,{className:c.link,to:"/users",id:"navigate-users",children:Object(ee.jsx)(ae,{icon:Object(ee.jsx)(J.a,{}),label:"users",width:a,color:"inherit"})}),Object(ee.jsx)(C.b,{className:c.link,to:"/applications",id:"navigate-apps",children:Object(ee.jsx)(ae,{icon:Object(ee.jsx)(W.a,{}),label:"apps",width:a,color:"inherit"})}),Object(ee.jsx)(C.b,{className:c.link,to:"/clients",id:"navigate-clients",children:Object(ee.jsx)(ae,{icon:Object(ee.jsx)(P.a,{}),label:"clients",width:a,color:"inherit"})}),Object(ee.jsx)(C.b,{className:c.link,to:"/plugins",id:"navigate-plugins",children:Object(ee.jsx)(ae,{icon:Object(ee.jsx)(G.a,{}),label:"plugins",width:a,color:"inherit"})}),Object(ee.jsx)(ae,{icon:Object(ee.jsx)(z.a,{}),label:e,onClick:s,id:"changepw",width:a,color:"inherit"}),Object(ee.jsx)(ae,{icon:Object(ee.jsx)(q.a,{}),label:"Logout",onClick:n,id:"logout",width:a,color:"inherit"})]})}}]),n}(a.Component))||d,ae=function(e){var t=e.width,n=e.icon,a=e.label,r=Object(S.a)(e,te);return"xs"===t||"sm"===t?Object(ee.jsx)(D.a,Object(o.a)(Object(o.a)({},r),{},{children:n})):Object(ee.jsx)(N.a,Object(o.a)(Object(o.a)({startIcon:n},r),{},{children:a}))},re=Object($.a)()(Object(y.a)((function(e){var t,n;return Object(A.a)({appBar:Object(g.a)({zIndex:e.zIndex.drawer+1},e.breakpoints.down("xs"),{paddingBottom:10}),toolbar:Object(g.a)({justifyContent:"space-between"},e.breakpoints.down("xs"),{flexWrap:"wrap"}),menuButtons:(t={display:"flex"},Object(g.a)(t,e.breakpoints.down("sm"),{flex:1}),Object(g.a)(t,"justifyContent","center"),Object(g.a)(t,e.breakpoints.down("xs"),{flexBasis:"100%",marginTop:5,order:1,justifyContent:"space-between"}),t),title:(n={},Object(g.a)(n,e.breakpoints.up("md"),{flex:1}),Object(g.a)(n,"display","flex"),Object(g.a)(n,"alignItems","center"),n),titleName:{paddingRight:10},link:{color:"inherit",textDecoration:"none"}})}),{withTheme:!0})(ne)),ie=n(471),ce=n(470),se=function(e){var t=e.title,n=e.rightControl,a=e.maxWidth,r=void 0===a?700:a,i=e.children;return Object(ee.jsx)("main",{style:{margin:"0 auto",maxWidth:r},children:Object(ee.jsxs)(ce.a,{container:!0,spacing:4,children:[Object(ee.jsxs)(ce.a,{item:!0,xs:12,style:{display:"flex",flexWrap:"wrap"},children:[Object(ee.jsx)(B.a,{variant:"h4",style:{flex:1},children:t}),n]}),i]})})};function oe(){return Object(ee.jsx)(se,{title:"",maxWidth:250,children:Object(ee.jsx)(ce.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(ee.jsx)(ie.a,{size:150})})})}var le=n(474),ue=n(496),de=n(472),he=n(473),je=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Q.b.apply(void 0,t)(e)}},be=function(e){var t=e.children,n=e.stores;return Object(ee.jsx)(Q.a,Object(o.a)(Object(o.a)({},n),{},{children:t}))},pe=n(81),fe=n.n(pe),Oe=n(214),me=n.n(Oe);function ge(){return fe.a.needsPermission&&fe.a.isSupported()&&"denied"!==Notification.permission}function xe(e){window.parent&&window.parent.focus(),window.focus(),window.location.href="/",e.target.close()}function ve(e){setTimeout((function(){e.target.close()}),5e3)}var ye,we,ke,Ce,Se,Ie,Ne,De,Ae,Me,Be=n(117),Te=n.n(Be),ze=["navOpen","setNavOpen","children"],Ee=Object(Q.c)(ye=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={showRequestNotification:ge()},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.loggedIn,r=t.appStore,i=t.navOpen,c=t.setNavOpen,s=this.state.showRequestNotification,o=r.getItems(),l=0===o.length?null:o.map((function(e){return Object(ee.jsx)(C.b,{onClick:function(){return c(!1)},className:"".concat(n.link," item"),to:"/messages/"+e.id,children:Object(ee.jsx)(de.a,{button:!0,children:Object(ee.jsx)(he.a,{primary:e.name})})},e.id)})),u=[Object(ee.jsx)(de.a,{button:!0,disabled:!0,children:Object(ee.jsx)(he.a,{primary:"Some Server"})},-1),Object(ee.jsx)(de.a,{button:!0,disabled:!0,children:Object(ee.jsx)(he.a,{primary:"A Raspberry PI"})},-2)];return Object(ee.jsxs)(We,{classes:{root:n.root,paper:n.drawerPaper},navOpen:i,setNavOpen:c,id:"message-navigation",children:[Object(ee.jsx)("div",{className:n.toolbar}),Object(ee.jsx)(C.b,{className:n.link,to:"/",onClick:function(){return c(!1)},children:Object(ee.jsx)(de.a,{button:!0,disabled:!a,className:"all",children:Object(ee.jsx)(he.a,{primary:"All Messages"})})}),Object(ee.jsx)(le.a,{}),Object(ee.jsx)("div",{children:a?l:u}),Object(ee.jsx)(le.a,{}),Object(ee.jsx)(B.a,{align:"center",style:{marginTop:10},children:s?Object(ee.jsx)(N.a,{onClick:function(){fe.a.needsPermission&&fe.a.isSupported()&&fe.a.requestPermission((function(){return console.log("granted notification permissions")}),(function(){return console.log("notification permission denied")})),e.setState({showRequestNotification:!1})},children:"Enable Notifications"}):null})]})}}]),n}(a.Component))||ye,We=function(e){var t=e.navOpen,n=e.setNavOpen,a=e.children,r=Object(S.a)(e,ze);return Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsx)(Z.a,{smUp:!0,implementation:"css",children:Object(ee.jsxs)(ue.a,Object(o.a)(Object(o.a)({variant:"temporary",open:t},r),{},{children:[Object(ee.jsx)(D.a,{onClick:function(){return n(!1)},children:Object(ee.jsx)(Te.a,{})}),a]}))}),Object(ee.jsx)(Z.a,{xsDown:!0,implementation:"css",children:Object(ee.jsx)(ue.a,Object(o.a)(Object(o.a)({variant:"permanent"},r),{},{children:a}))})]})},Ue=Object(y.a)((function(e){return{root:{height:"100%"},drawerPaper:{position:"relative",width:250,minHeight:"100%",height:"100vh"},toolbar:e.mixins.toolbar,link:{color:"inherit",textDecoration:"none"}}}),{withTheme:!0})(je("appStore")(Ee)),Pe=n(476),_e=n(215),qe=n.n(_e),Le=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={display:"none",opacity:0},e.scrollHandler=function(){var t=window.pageYOffset,n={display:t>0?"inherit":"none",opacity:Math.min(t/500,1)};e.state.display===n.display&&e.state.opacity===n.opacity||e.setState(n)},e.scrollUp=function(){return window.scrollTo(0,0)},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.scrollHandler)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.scrollHandler)}},{key:"render",value:function(){return Object(ee.jsx)(Pe.a,{color:"primary",style:{position:"fixed",bottom:"30px",right:"30px",zIndex:1e5,display:this.state.display,opacity:this.state.opacity},onClick:this.scrollUp,children:Object(ee.jsx)(qe.a,{})})}}]),n}(a.Component),Fe=Le,Re=n(477),He=n(481),Ke=n(479),Ve=n(478),Ye=n(491),Ge=n(497),Xe=n(3),Je=Object(Q.c)((ke=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"pass",Ce,Object(p.a)(e)),e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.pass,n=this.props,a=n.fClose,r=n.currentUser;return Object(ee.jsxs)(Re.a,{open:!0,onClose:a,"aria-labelledby":"form-dialog-title",id:"changepw-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:"Change Password"}),Object(ee.jsx)(Ke.a,{children:Object(ee.jsx)(Ye.a,{className:"newpass",autoFocus:!0,margin:"dense",type:"password",label:"New Password *",value:t,onChange:function(t){return e.pass=t.target.value},fullWidth:!0})}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:a,children:"Cancel"}),Object(ee.jsx)(Ge.a,{title:0!==t.length?"":"Password is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"change",disabled:0===t.length,onClick:function(){r.changePassword(t),a()},color:"primary",variant:"contained",children:"Change"})})})]})]})}}]),n}(a.Component),Ce=Object(m.a)(ke.prototype,"pass",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),we=ke))||we,Qe=je("currentUser")(Je),Ze=n(493),$e=Object(Q.c)((Me=Ae=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"open",Ne,Object(p.a)(e)),Object(h.a)(e,"openWhen",De,Object(p.a)(e)),e.dispose=function(){},e.componentDidMount=function(){return e.dispose=Object(Xe.E)((function(){return e.props.snackManager.counter}),e.onNewSnack)},e.componentWillUnmount=function(){return e.dispose()},e.onNewSnack=function(){var t=Object(p.a)(e),a=t.open,r=t.openWhen;if(a){var i=Date.now()-r;i>n.MIN_VISIBLE_SNACK_TIME_IN_MS?e.closeCurrentSnack():setTimeout(e.closeCurrentSnack,n.MIN_VISIBLE_SNACK_TIME_IN_MS-i)}else e.openNextSnack()},e.openNextSnack=function(){e.props.snackManager.hasNext()&&(e.open=!0,e.openWhen=Date.now(),e.props.snackManager.next())},e.closeCurrentSnack=function(){return e.open=!1},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.snackManager,t=e.message,a=(0,e.hasNext)()?n.MIN_VISIBLE_SNACK_TIME_IN_MS:n.MAX_VISIBLE_SNACK_TIME_IN_MS;return Object(ee.jsx)(Ze.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.open,autoHideDuration:a,onClose:this.closeCurrentSnack,onExited:this.openNextSnack,message:Object(ee.jsx)("span",{id:"message-id",children:t}),action:Object(ee.jsx)(D.a,{"aria-label":"Close",color:"inherit",onClick:this.closeCurrentSnack,children:Object(ee.jsx)(Te.a,{})},"close")})}}]),n}(a.Component),Ae.MAX_VISIBLE_SNACK_TIME_IN_MS=6e3,Ae.MIN_VISIBLE_SNACK_TIME_IN_MS=1e3,Ie=Me,Ne=Object(m.a)(Ie.prototype,"open",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),De=Object(m.a)(Ie.prototype,"openWhen",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Se=Ie))||Se,et=je("snackManager")($e),tt=n(498),nt=n(233),at=n(483),rt=n(487),it=n(486),ct=n(484),st=n(485),ot=n(67),lt=n.n(ot),ut=n(89),dt=n.n(ut),ht=n(219),jt=n.n(ht),bt=n(482);function pt(e){var t=e.title,n=e.text,a=e.fClose,r=e.fOnSubmit;return Object(ee.jsxs)(Re.a,{open:!0,onClose:a,"aria-labelledby":"form-dialog-title",className:"confirm-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:t}),Object(ee.jsx)(Ke.a,{children:Object(ee.jsx)(bt.a,{children:n})}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:a,className:"cancel",children:"No"}),Object(ee.jsx)(N.a,{onClick:function(){r(),a()},autoFocus:!0,color:"primary",variant:"contained",className:"confirm",children:"Yes"})]})]})}var ft,Ot,mt,gt,xt,vt,yt,wt,kt,Ct,St,It,Nt,Dt,At,Mt,Bt,Tt=n(218),zt=n.n(Tt),Et=n(217),Wt=n.n(Et),Ut=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1},e.toggleVisibility=function(){return e.setState({visible:!e.state.visible})},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.style,a=this.state.visible?t:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022";return Object(ee.jsxs)("div",{style:n,children:[Object(ee.jsx)(D.a,{onClick:this.toggleVisibility,className:"toggle-visibility",children:this.state.visible?Object(ee.jsx)(Wt.a,{}):Object(ee.jsx)(zt.a,{})}),Object(ee.jsx)(B.a,{style:{fontFamily:"monospace",fontSize:16},children:a})]})}}]),n}(a.Component),Pt=Ut,_t=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={name:"",description:""},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.fClose,n=e.fOnSubmit,a=this.state,r=a.name,i=a.description,c=0!==this.state.name.length;return Object(ee.jsxs)(Re.a,{open:!0,onClose:t,"aria-labelledby":"form-dialog-title",id:"app-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:"Create an application"}),Object(ee.jsxs)(Ke.a,{children:[Object(ee.jsx)(bt.a,{children:"An application is allowed to send messages."}),Object(ee.jsx)(Ye.a,{autoFocus:!0,margin:"dense",className:"name",label:"Name *",type:"text",value:r,onChange:this.handleChange.bind(this,"name"),fullWidth:!0}),Object(ee.jsx)(Ye.a,{margin:"dense",className:"description",label:"Short Description",value:i,onChange:this.handleChange.bind(this,"description"),fullWidth:!0,multiline:!0})]}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:t,children:"Cancel"}),Object(ee.jsx)(Ge.a,{title:c?"":"name is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"create",disabled:!c,onClick:function(){n(r,i),t()},color:"primary",variant:"contained",children:"Create"})})})]})]})}},{key:"handleChange",value:function(e,t){var n=this.state;n[e]=t.target.value,this.setState(n)}}]),n}(a.Component),qt=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this,e)).state={name:"",description:""},a.state={name:e.initialName,description:e.initialDescription},a}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.fClose,n=e.fOnSubmit,a=this.state,r=a.name,i=a.description,c=0!==this.state.name.length;return Object(ee.jsxs)(Re.a,{open:!0,onClose:t,"aria-labelledby":"form-dialog-title",id:"app-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:"Update an application"}),Object(ee.jsxs)(Ke.a,{children:[Object(ee.jsx)(bt.a,{children:"An application is allowed to send messages."}),Object(ee.jsx)(Ye.a,{autoFocus:!0,margin:"dense",className:"name",label:"Name *",type:"text",value:r,onChange:this.handleChange.bind(this,"name"),fullWidth:!0}),Object(ee.jsx)(Ye.a,{margin:"dense",className:"description",label:"Short Description",value:i,onChange:this.handleChange.bind(this,"description"),fullWidth:!0,multiline:!0})]}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:t,children:"Cancel"}),Object(ee.jsx)(Ge.a,{title:c?"":"name is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"update",disabled:!c,onClick:function(){n(r,i),t()},color:"primary",variant:"contained",children:"Update"})})})]})]})}},{key:"handleChange",value:function(e,t){var n=this.state;n[e]=t.target.value,this.setState(n)}}]),n}(a.Component),Lt=Object(Q.c)((Ot=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"deleteId",mt,Object(p.a)(e)),Object(h.a)(e,"updateId",gt,Object(p.a)(e)),Object(h.a)(e,"createDialog",xt,Object(p.a)(e)),e.uploadId=-1,e.upload=null,e.componentDidMount=function(){return e.props.appStore.refresh()},e.uploadImage=function(t){e.uploadId=t,e.upload&&e.upload.click()},e.onUploadImage=function(t){var n,a=null===(n=t.target.files)||void 0===n?void 0:n[0];a&&(-1!==["image/png","image/jpeg","image/gif"].indexOf(a.type)?e.props.appStore.uploadImage(e.uploadId,a):alert("Uploaded file must be of type png, jpeg or gif."))},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.createDialog,n=this.deleteId,a=this.updateId,r=this.props.appStore,i=r.getItems();return Object(ee.jsxs)(se,{title:"Applications",rightControl:Object(ee.jsx)(N.a,{id:"create-app",variant:"contained",color:"primary",onClick:function(){return e.createDialog=!0},children:"Create Application"}),maxWidth:1e3,children:[Object(ee.jsx)(ce.a,{item:!0,xs:12,children:Object(ee.jsxs)(nt.a,{elevation:6,children:[Object(ee.jsxs)(at.a,{id:"app-table",children:[Object(ee.jsx)(ct.a,{children:Object(ee.jsxs)(st.a,{children:[Object(ee.jsx)(it.a,{padding:"checkbox",style:{width:80}}),Object(ee.jsx)(it.a,{children:"Name"}),Object(ee.jsx)(it.a,{children:"Token"}),Object(ee.jsx)(it.a,{children:"Description"}),Object(ee.jsx)(it.a,{}),Object(ee.jsx)(it.a,{})]})}),Object(ee.jsx)(rt.a,{children:i.map((function(t){return Object(ee.jsx)(Ft,{description:t.description,image:t.image,name:t.name,value:t.token,fUpload:function(){return e.uploadImage(t.id)},fDelete:function(){return e.deleteId=t.id},fEdit:function(){return e.updateId=t.id},noDelete:t.internal},t.id)}))})]}),Object(ee.jsx)("input",{ref:function(t){return e.upload=t},type:"file",style:{display:"none"},onChange:this.onUploadImage})]})}),t&&Object(ee.jsx)(_t,{fClose:function(){return e.createDialog=!1},fOnSubmit:r.create}),!1!==a&&Object(ee.jsx)(qt,{fClose:function(){return e.updateId=!1},fOnSubmit:function(e,t){return r.update(a,e,t)},initialDescription:r.getByID(a).description,initialName:r.getByID(a).name}),!1!==n&&Object(ee.jsx)(pt,{title:"Confirm Delete",text:"Delete "+r.getByID(n).name+"?",fClose:function(){return e.deleteId=!1},fOnSubmit:function(){return r.remove(n)}})]})}}]),n}(a.Component),mt=Object(m.a)(Ot.prototype,"deleteId",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gt=Object(m.a)(Ot.prototype,"updateId",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xt=Object(m.a)(Ot.prototype,"createDialog",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ft=Ot))||ft,Ft=Object(Q.c)((function(e){var t=e.name,n=e.value,a=e.noDelete,r=e.description,i=e.fDelete,c=e.fUpload,s=e.image,o=e.fEdit;return Object(ee.jsxs)(st.a,{children:[Object(ee.jsx)(it.a,{padding:"default",children:Object(ee.jsxs)("div",{style:{display:"flex"},children:[Object(ee.jsx)(tt.a,{src:u("url")+s}),Object(ee.jsx)(D.a,{onClick:c,style:{height:40},children:Object(ee.jsx)(jt.a,{})})]})}),Object(ee.jsx)(it.a,{children:t}),Object(ee.jsx)(it.a,{children:Object(ee.jsx)(Pt,{value:n,style:{display:"flex",alignItems:"center"}})}),Object(ee.jsx)(it.a,{children:r}),Object(ee.jsx)(it.a,{align:"right",padding:"none",children:Object(ee.jsx)(D.a,{onClick:o,className:"edit",children:Object(ee.jsx)(dt.a,{})})}),Object(ee.jsx)(it.a,{align:"right",padding:"none",children:Object(ee.jsx)(D.a,{onClick:i,className:"delete",disabled:a,children:Object(ee.jsx)(lt.a,{})})})]})})),Rt=je("appStore")(Lt),Ht=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={name:""},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.fClose,n=e.fOnSubmit,a=this.state.name,r=0!==this.state.name.length;return Object(ee.jsxs)(Re.a,{open:!0,onClose:t,"aria-labelledby":"form-dialog-title",id:"client-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:"Create a client"}),Object(ee.jsx)(Ke.a,{children:Object(ee.jsx)(Ye.a,{autoFocus:!0,margin:"dense",className:"name",label:"Name *",type:"email",value:a,onChange:this.handleChange.bind(this,"name"),fullWidth:!0})}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:t,children:"Cancel"}),Object(ee.jsx)(Ge.a,{placement:"bottom-start",title:r?"":"name is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"create",disabled:!r,onClick:function(){n(a),t()},color:"primary",variant:"contained",children:"Create"})})})]})]})}},{key:"handleChange",value:function(e,t){var n=this.state;n[e]=t.target.value,this.setState(n)}}]),n}(a.Component),Kt=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this,e)).state={name:""},a.state={name:e.initialName},a}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.fClose,n=e.fOnSubmit,a=this.state.name,r=0!==this.state.name.length;return Object(ee.jsxs)(Re.a,{open:!0,onClose:t,"aria-labelledby":"form-dialog-title",id:"client-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:"Update a Client"}),Object(ee.jsxs)(Ke.a,{children:[Object(ee.jsx)(bt.a,{children:"A client manages messages, clients, applications and users (with admin permissions)."}),Object(ee.jsx)(Ye.a,{autoFocus:!0,margin:"dense",className:"name",label:"Name *",type:"text",value:a,onChange:this.handleChange.bind(this,"name"),fullWidth:!0})]}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:t,children:"Cancel"}),Object(ee.jsx)(Ge.a,{title:r?"":"name is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"update",disabled:!r,onClick:function(){n(a),t()},color:"primary",variant:"contained",children:"Update"})})})]})]})}},{key:"handleChange",value:function(e,t){var n={};n[e]=t.target.value,this.setState(n)}}]),n}(a.Component),Vt=Object(Q.c)((yt=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"showDialog",wt,Object(p.a)(e)),Object(h.a)(e,"deleteId",kt,Object(p.a)(e)),Object(h.a)(e,"updateId",Ct,Object(p.a)(e)),e.componentDidMount=function(){return e.props.clientStore.refresh()},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.deleteId,n=this.updateId,a=this.showDialog,r=this.props.clientStore,i=r.getItems();return Object(ee.jsxs)(se,{title:"Clients",rightControl:Object(ee.jsx)(N.a,{id:"create-client",variant:"contained",color:"primary",onClick:function(){return e.showDialog=!0},children:"Create Client"}),children:[Object(ee.jsx)(ce.a,{item:!0,xs:12,children:Object(ee.jsx)(nt.a,{elevation:6,children:Object(ee.jsxs)(at.a,{id:"client-table",children:[Object(ee.jsx)(ct.a,{children:Object(ee.jsxs)(st.a,{style:{textAlign:"center"},children:[Object(ee.jsx)(it.a,{children:"Name"}),Object(ee.jsx)(it.a,{style:{width:200},children:"Token"}),Object(ee.jsx)(it.a,{}),Object(ee.jsx)(it.a,{})]})}),Object(ee.jsx)(rt.a,{children:i.map((function(t){return Object(ee.jsx)(Yt,{name:t.name,value:t.token,fEdit:function(){return e.updateId=t.id},fDelete:function(){return e.deleteId=t.id}},t.id)}))})]})})}),a&&Object(ee.jsx)(Ht,{fClose:function(){return e.showDialog=!1},fOnSubmit:r.create}),!1!==n&&Object(ee.jsx)(Kt,{fClose:function(){return e.updateId=!1},fOnSubmit:function(e){return r.update(n,e)},initialName:r.getByID(n).name}),!1!==t&&Object(ee.jsx)(pt,{title:"Confirm Delete",text:"Delete "+r.getByID(t).name+"?",fClose:function(){return e.deleteId=!1},fOnSubmit:function(){return r.remove(t)}})]})}}]),n}(a.Component),wt=Object(m.a)(yt.prototype,"showDialog",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kt=Object(m.a)(yt.prototype,"deleteId",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ct=Object(m.a)(yt.prototype,"updateId",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vt=yt))||vt,Yt=function(e){var t=e.name,n=e.value,a=e.fEdit,r=e.fDelete;return Object(ee.jsxs)(st.a,{children:[Object(ee.jsx)(it.a,{children:t}),Object(ee.jsx)(it.a,{children:Object(ee.jsx)(Pt,{value:n,style:{display:"flex",alignItems:"center",width:200}})}),Object(ee.jsx)(it.a,{align:"right",padding:"none",children:Object(ee.jsx)(D.a,{onClick:a,className:"edit",children:Object(ee.jsx)(dt.a,{})})}),Object(ee.jsx)(it.a,{align:"right",padding:"none",children:Object(ee.jsx)(D.a,{onClick:r,className:"delete",children:Object(ee.jsx)(lt.a,{})})})]})},Gt=je("clientStore")(Vt),Xt=n(220),Jt=n.n(Xt),Qt=n(499),Zt=Object(Q.c)(St=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){return e.props.pluginStore.refresh()},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.props.pluginStore.getItems();return Object(ee.jsx)(se,{title:"Plugins",maxWidth:1e3,children:Object(ee.jsx)(ce.a,{item:!0,xs:12,children:Object(ee.jsx)(nt.a,{elevation:6,children:Object(ee.jsxs)(at.a,{id:"plugin-table",children:[Object(ee.jsx)(ct.a,{children:Object(ee.jsxs)(st.a,{children:[Object(ee.jsx)(it.a,{children:"ID"}),Object(ee.jsx)(it.a,{children:"Enabled"}),Object(ee.jsx)(it.a,{children:"Name"}),Object(ee.jsx)(it.a,{children:"Token"}),Object(ee.jsx)(it.a,{children:"Details"})]})}),Object(ee.jsx)(rt.a,{children:t.map((function(t){return Object(ee.jsx)($t,{id:t.id,token:t.token,name:t.name,enabled:t.enabled,fToggleStatus:function(){return e.props.pluginStore.changeEnabledState(t.id,!t.enabled)}},t.token)}))})]})})})})}}]),n}(a.Component))||St,$t=Object(Q.c)((function(e){var t=e.name,n=e.id,a=e.token,r=e.enabled,i=e.fToggleStatus;return Object(ee.jsxs)(st.a,{children:[Object(ee.jsx)(it.a,{children:n}),Object(ee.jsx)(it.a,{children:Object(ee.jsx)(Qt.a,{checked:r,onClick:i,className:"switch","data-enabled":r})}),Object(ee.jsx)(it.a,{children:t}),Object(ee.jsx)(it.a,{children:Object(ee.jsx)(Pt,{value:a,style:{display:"flex",alignItems:"center"}})}),Object(ee.jsx)(it.a,{align:"right",padding:"none",children:Object(ee.jsx)(C.b,{to:"/plugins/"+n,children:Object(ee.jsx)(N.a,{children:Object(ee.jsx)(Jt.a,{})})})})]})})),en=je("pluginStore")(Zt),tn=n(12),nn=n.n(tn),an=n(23),rn=n(221),cn=n.n(rn),sn=n(222),on=n.n(sn),ln=function(e){var t=e.children;return Object(ee.jsx)(cn.a,{plugins:[on.a],children:t})},un=n(223),dn=(n(410),n(411),n(412),n(224)),hn=n.n(dn),jn=n(225),bn=n.n(jn),pn=n(226),fn=n.n(pn),On=n(227),mn=n.n(On),gn=Object(y.a)((function(){return{paper:{padding:16}}}))((function(e){var t=e.classes,n=e.children,a=e.style;return Object(ee.jsx)(nt.a,{elevation:6,className:t.paper,style:a,children:n})})),xn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).pluginID=parseInt(e.props.match.params.id,10),e.pluginInfo=function(){return e.props.pluginStore.getByID(e.pluginID)},e.state={displayText:null,currentConfig:null},e}return Object(b.a)(n,[{key:"componentWillMount",value:function(){this.refreshFeatures()}},{key:"componentWillReceiveProps",value:function(e){this.pluginID=parseInt(e.match.params.id,10),this.refreshFeatures()}},{key:"refreshFeatures",value:function(){return Promise.all([this.refreshConfigurer(),this.refreshDisplayer()])}},{key:"refreshConfigurer",value:function(){var e=Object(an.a)(nn.a.mark((function e(){var t,n;return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.pluginStore,-1===this.pluginInfo().capabilities.indexOf("configurer")){e.next=6;break}return e.next=4,t.requestConfig(this.pluginID);case 4:n=e.sent,this.setState({currentConfig:n});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refreshDisplayer",value:function(){var e=Object(an.a)(nn.a.mark((function e(){var t,n;return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.pluginStore,-1===this.pluginInfo().capabilities.indexOf("displayer")){e.next=6;break}return e.next=4,t.requestDisplay(this.pluginID);case 4:n=e.sent,this.setState({displayText:n});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.pluginInfo(),n=t.name,a=t.capabilities;return Object(ee.jsxs)(se,{title:n,maxWidth:1e3,children:[Object(ee.jsx)(vn,{name:"Plugin Info",icon:hn.a,children:Object(ee.jsx)(kn,{pluginInfo:t})}),-1!==a.indexOf("configurer")?Object(ee.jsx)(vn,{name:"Configurer",description:"This is the configuration panel for this plugin.",icon:bn.a,refresh:this.refreshConfigurer.bind(this),children:Object(ee.jsx)(yn,{pluginInfo:t,initialConfig:null!==this.state.currentConfig?this.state.currentConfig:"Loading...",save:function(){var t=Object(an.a)(nn.a.mark((function t(n){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.pluginStore.changeConfig(e.pluginID,n);case 2:return t.next=4,e.refreshFeatures();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})}):null," ",-1!==a.indexOf("displayer")?Object(ee.jsx)(vn,{name:"Displayer",description:"This is the information generated by the plugin.",refresh:this.refreshDisplayer.bind(this),icon:fn.a,children:Object(ee.jsx)(wn,{pluginInfo:t,displayText:null!==this.state.displayText?this.state.displayText:"Loading..."})}):null]})}}]),n}(a.Component),vn=function(e){var t=e.name,n=e.description,a=e.refresh,r=e.icon,i=e.children,c=r;return Object(ee.jsxs)(gn,{style:{display:"block",width:"100%",margin:"20px"},children:[Object(ee.jsxs)(B.a,{variant:"h5",children:[c?Object(ee.jsxs)("span",{children:[Object(ee.jsx)(c,{}),"\xa0"]}):null,t,a?Object(ee.jsx)(N.a,{style:{float:"right"},onClick:function(){a()},children:Object(ee.jsx)(mn.a,{})}):null]}),n?Object(ee.jsx)(B.a,{variant:"subtitle1",children:n}):null,Object(ee.jsx)("hr",{}),Object(ee.jsx)("div",{className:t.toLowerCase().trim().replace(/ /g,"-"),children:i})]})},yn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={unsavedChanges:null},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this;return Object(ee.jsxs)("div",{children:[Object(ee.jsx)(un.UnControlled,{value:this.props.initialConfig,options:{mode:"yaml",theme:"material",lineNumbers:!0},onChange:function(t,n,a){var r=a;a===e.props.initialConfig&&(r=null),e.setState({unsavedChanges:r})}}),Object(ee.jsx)("br",{}),Object(ee.jsx)(N.a,{variant:"contained",color:"primary",fullWidth:!0,disabled:null===this.state.unsavedChanges||this.state.unsavedChanges===this.props.initialConfig,className:"config-save",onClick:function(){var t=e.state.unsavedChanges;e.props.save(t).then((function(){e.setState({unsavedChanges:null})}))},children:Object(ee.jsx)(B.a,{variant:"button",children:"Save"})})]})}}]),n}(a.Component),wn=function(e){var t=e.displayText;return Object(ee.jsx)(B.a,{variant:"body2",children:Object(ee.jsx)(ln,{children:t})})},kn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e,t=this.props.pluginInfo,n=t.name,a=t.author,r=t.modulePath,i=t.website,c=t.license,s=t.capabilities,o=t.id,l=t.token;return Object(ee.jsxs)("div",{children:[n?Object(ee.jsxs)(B.a,{variant:"body2",className:"name",children:["Name: ",Object(ee.jsx)("span",{children:n})]}):null,a?Object(ee.jsxs)(B.a,{variant:"body2",className:"author",children:["Author: ",Object(ee.jsx)("span",{children:a})]}):null,Object(ee.jsxs)(B.a,{variant:"body2",className:"module-path",children:["Module Path: ",Object(ee.jsx)("span",{children:r})]}),i?Object(ee.jsxs)(B.a,{variant:"body2",className:"website",children:["Website: ",Object(ee.jsx)("span",{children:i})]}):null,c?Object(ee.jsxs)(B.a,{variant:"body2",className:"license",children:["License: ",Object(ee.jsx)("span",{children:c})]}):null,Object(ee.jsxs)(B.a,{variant:"body2",className:"capabilities",children:["Capabilities: ",Object(ee.jsx)("span",{children:s.join(", ")})]}),-1!==s.indexOf("webhooker")?Object(ee.jsxs)(B.a,{variant:"body2",children:["Custom Route Prefix:"," ",(e="".concat(u("url"),"plugin/").concat(o,"/custom/").concat(l,"/"),Object(ee.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"custom-route",children:e}))]}):null]})}}]),n}(a.Component),Cn=je("pluginStore")(xn),Sn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={name:"",pass:""},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.fClose,n=e.fOnSubmit,a=this.state,r=a.name,i=a.pass,c=0!==this.state.name.length,s=0!==this.state.pass.length;return Object(ee.jsxs)(Re.a,{open:!0,onClose:t,"aria-labelledby":"form-dialog-title",id:"add-edit-user-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:"Registration"}),Object(ee.jsxs)(Ke.a,{children:[Object(ee.jsx)(Ye.a,{autoFocus:!0,margin:"dense",className:"name",label:"Name *",type:"email",value:r,onChange:this.handleChange.bind(this,"name"),fullWidth:!0}),Object(ee.jsx)(Ye.a,{margin:"dense",className:"password",type:"password",value:i,fullWidth:!0,label:"Pass *",onChange:this.handleChange.bind(this,"pass")})]}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:t,children:"Cancel"}),Object(ee.jsx)(Ge.a,{placement:"bottom-start",title:c?s?"":"password is required":"name is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"save-create",disabled:!s||!c,onClick:function(){n(r,i).then((function(e){e&&t()}))},color:"primary",variant:"contained",children:"Register"})})})]})]})}},{key:"handleChange",value:function(e,t){var n=this.state;n[e]=t.target.value,this.setState(n)}}]),n}(a.Component),In=Object(Q.c)((Nt=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"username",Dt,Object(p.a)(e)),Object(h.a)(e,"password",At,Object(p.a)(e)),Object(h.a)(e,"registerDialog",Mt,Object(p.a)(e)),e.login=function(t){t.preventDefault(),e.props.currentUser.login(e.username,e.password)},e.registerButton=function(){return u("register")?Object(ee.jsx)(N.a,{id:"register",variant:"contained",color:"primary",onClick:function(){return e.registerDialog=!0},children:"Register"}):null},e.preventDefault=function(e){return e.preventDefault()},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.username,n=this.password,a=this.registerDialog;return Object(ee.jsxs)(se,{title:"Login",rightControl:this.registerButton(),maxWidth:250,children:[Object(ee.jsx)(ce.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(ee.jsx)(gn,{children:Object(ee.jsxs)("form",{onSubmit:this.preventDefault,id:"login-form",children:[Object(ee.jsx)(Ye.a,{autoFocus:!0,className:"name",label:"Username",margin:"dense",autoComplete:"username",value:t,onChange:function(t){return e.username=t.target.value}}),Object(ee.jsx)(Ye.a,{type:"password",className:"password",label:"Password",margin:"normal",autoComplete:"current-password",value:n,onChange:function(t){return e.password=t.target.value}}),Object(ee.jsx)(N.a,{type:"submit",variant:"contained",size:"large",className:"login",color:"primary",disabled:!!this.props.currentUser.connectionErrorMessage,style:{marginTop:15,marginBottom:5},onClick:this.login,children:"Login"})]})})}),a&&Object(ee.jsx)(Sn,{fClose:function(){return e.registerDialog=!1},fOnSubmit:this.props.currentUser.register})]})}}]),n}(a.Component),Dt=Object(m.a)(Nt.prototype,"username",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),At=Object(m.a)(Nt.prototype,"password",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Mt=Object(m.a)(Nt.prototype,"registerDialog",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),It=Nt))||It,Nn=je("currentUser")(In),Dn=n(232);!function(e){e.Markdown="text/markdown",e.Plain="text/plain"}(Bt||(Bt={}));var An,Mn,Bn,Tn,zn,En,Wn,Un,Pn,_n,qn,Ln,Fn,Rn=function(e){var t=Hn(e,"client::display","contentType");return Object.keys(Bt).map((function(e){return Bt[e]})).some((function(e){return e===t}))?t:Bt.Plain},Hn=function(e,t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},Kn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).node=null,e.componentDidMount=function(){return e.props.height(e.node?e.node.getBoundingClientRect().height:0)},e.renderContent=function(){var t=e.props.content;switch(Rn(e.props.extras)){case Bt.Markdown:return Object(ee.jsx)(ln,{children:t});case Bt.Plain:default:return Object(ee.jsx)("span",{className:e.props.classes.plainContent,children:t})}},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.fDelete,a=t.classes,r=t.title,i=t.date,c=t.image;return Object(ee.jsx)("div",{className:"".concat(a.wrapperPadding," message"),ref:function(t){return e.node=t},children:Object(ee.jsxs)(gn,{style:{display:"flex"},children:[Object(ee.jsx)("div",{className:a.imageWrapper,children:null!==c?Object(ee.jsx)("img",{src:u("url")+c,alt:"app logo",width:"70",height:"70",className:a.image}):null}),Object(ee.jsxs)("div",{className:a.messageContentWrapper,children:[Object(ee.jsxs)("div",{className:a.header,children:[Object(ee.jsx)(B.a,{className:"".concat(a.headerTitle," title"),variant:"h5",children:r}),Object(ee.jsx)(B.a,{variant:"body1",className:a.date,children:Object(ee.jsx)(Dn.a,{date:i})}),Object(ee.jsx)(D.a,{onClick:n,className:"".concat(a.trash," delete"),children:Object(ee.jsx)(lt.a,{})})]}),Object(ee.jsx)(B.a,{component:"div",className:"".concat(a.content," content"),children:this.renderContent()})]})]})})}}]),n}(r.a.PureComponent),Vn=Object(y.a)((function(e){return Object(A.a)({header:{display:"flex",flexWrap:"wrap",marginBottom:0},headerTitle:{flex:1},trash:{marginTop:-15,marginRight:-15},wrapperPadding:{padding:12},messageContentWrapper:{width:"100%",maxWidth:585},image:Object(g.a)({marginRight:15},e.breakpoints.down("sm"),{width:32,height:32}),date:Object(g.a)({},e.breakpoints.down("sm"),{order:1,flexBasis:"100%",opacity:.7}),imageWrapper:{display:"flex"},plainContent:{whiteSpace:"pre-wrap"},content:{wordBreak:"break-all","& p":{margin:0},"& a":{color:"#ff7f50"},"& pre":{overflow:"auto"},"& img":{maxWidth:"100%"}}})}),{withTheme:!0})(Kn),Yn=n(228),Gn=n.n(Yn),Xn=Object(Q.c)((Mn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"heights",Bn,Object(p.a)(e)),e.state={appId:-1},e.isLoadingMore=!1,e.updateAllWithProps=function(t){var a=n.appId(t);e.setState({appId:a}),t.messagesStore.exists(a)||t.messagesStore.loadMore(a)},e.updateAll=function(){return e.updateAllWithProps(e.props)},e.deleteMessage=function(t){return function(){return e.props.messagesStore.removeSingle(t)}},e.renderMessage=function(t){return Object(ee.jsx)(Vn,{height:function(n){e.heights[t.id]||(e.heights[t.id]=n)},fDelete:e.deleteMessage(t),title:t.title,date:t.date,content:t.message,image:t.image,extras:t.extras},t.id)},e.label=function(e){return Object(ee.jsx)(ce.a,{item:!0,xs:12,children:Object(ee.jsx)(B.a,{variant:"caption",component:"div",gutterBottom:!0,align:"center",children:e})})},e}return Object(b.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.updateAllWithProps(e)}},{key:"componentWillMount",value:function(){var e=this;window.onscroll=function(){window.innerHeight+window.pageYOffset>=document.body.offsetHeight-2*window.innerHeight&&e.checkIfLoadMore()},this.updateAll()}},{key:"render",value:function(){var e=this,t=this.state.appId,n=this.props,a=n.messagesStore,r=n.appStore,i=a.get(t),c=a.canLoadMore(t),s=r.getName(t),o=0!==i.length;return Object(ee.jsx)(se,{title:s,rightControl:Object(ee.jsxs)("div",{children:[Object(ee.jsx)(N.a,{id:"refresh-all",variant:"contained",disabled:!o,color:"primary",onClick:function(){return a.refreshByApp(t)},style:{marginRight:5},children:"Refresh"}),Object(ee.jsx)(N.a,{id:"delete-all",variant:"contained",disabled:!o,color:"primary",onClick:function(){return a.removeByApp(t)},children:"Delete All"})]}),children:o?Object(ee.jsxs)("div",{style:{width:"100%"},id:"messages",children:[Object(ee.jsx)(Gn.a,{useWindowAsScrollContainer:!0,preloadBatchSize:3*window.innerHeight,elementHeight:i.map((function(t){return e.heights[t.id]||1})),children:i.map(this.renderMessage)},t),c?Object(ee.jsx)(ce.a,{item:!0,xs:12,style:{textAlign:"center"},children:Object(ee.jsx)(ie.a,{size:100})}):this.label("You've reached the end")]}):this.label("No messages")})}},{key:"checkIfLoadMore",value:function(){var e=this,t=this.state.appId;!this.isLoadingMore&&this.props.messagesStore.canLoadMore(t)&&(this.isLoadingMore=!0,this.props.messagesStore.loadMore(t).then((function(){return e.isLoadingMore=!1})))}}],[{key:"appId",value:function(e){if(void 0===e)return-1;var t=e.match;return void 0!==t.params.id?parseInt(t.params.id,10):-1}}]),n}(a.Component),Bn=Object(m.a)(Mn.prototype,"heights",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),An=Mn))||An,Jn=je("messagesStore","appStore")(Xn),Qn=n(488),Zn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e,a,r;Object(j.a)(this,n);for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];return(r=t.call.apply(t,[this].concat(c))).state={name:null!==(e=r.props.name)&&void 0!==e?e:"",pass:"",admin:null!==(a=r.props.admin)&&void 0!==a&&a},r}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.fClose,n=e.fOnSubmit,a=e.isEdit,r=this.state,i=r.name,c=r.pass,s=r.admin,o=0!==this.state.name.length,l=0!==this.state.pass.length||a;return Object(ee.jsxs)(Re.a,{open:!0,onClose:t,"aria-labelledby":"form-dialog-title",id:"add-edit-user-dialog",children:[Object(ee.jsx)(Ve.a,{id:"form-dialog-title",children:a?"Edit "+this.props.name:"Add a user"}),Object(ee.jsxs)(Ke.a,{children:[Object(ee.jsx)(Ye.a,{autoFocus:!0,margin:"dense",className:"name",label:"Name *",type:"email",value:i,onChange:this.handleChange.bind(this,"name"),fullWidth:!0}),Object(ee.jsx)(Ye.a,{margin:"dense",className:"password",type:"password",value:c,fullWidth:!0,label:a?"Pass (empty if no change)":"Pass *",onChange:this.handleChange.bind(this,"pass")}),Object(ee.jsx)(Qn.a,{control:Object(ee.jsx)(Qt.a,{checked:s,className:"admin-rights",onChange:this.handleChecked.bind(this,"admin"),value:"admin"}),label:"has administrator rights"})]}),Object(ee.jsxs)(He.a,{children:[Object(ee.jsx)(N.a,{onClick:t,children:"Cancel"}),Object(ee.jsx)(Ge.a,{placement:"bottom-start",title:o?l?"":"password is required":"name is required",children:Object(ee.jsx)("div",{children:Object(ee.jsx)(N.a,{className:"save-create",disabled:!l||!o,onClick:function(){n(i,c,s),t()},color:"primary",variant:"contained",children:a?"Save":"Create"})})})]})]})}},{key:"handleChange",value:function(e,t){var n=this.state;n[e]=t.target.value,this.setState(n)}},{key:"handleChecked",value:function(e,t){var n=this.state;n[e]=t.target.checked,this.setState(n)}}]),n}(a.Component),$n=function(e){var t=e.name,n=e.admin,a=e.fDelete,r=e.fEdit;return Object(ee.jsxs)(st.a,{children:[Object(ee.jsx)(it.a,{children:t}),Object(ee.jsx)(it.a,{children:n?"Yes":"No"}),Object(ee.jsxs)(it.a,{align:"right",padding:"none",children:[Object(ee.jsx)(D.a,{onClick:r,className:"edit",children:Object(ee.jsx)(dt.a,{})}),Object(ee.jsx)(D.a,{onClick:a,className:"delete",children:Object(ee.jsx)(lt.a,{})})]})]})},ea=Object(Q.c)((zn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"createDialog",En,Object(p.a)(e)),Object(h.a)(e,"deleteId",Wn,Object(p.a)(e)),Object(h.a)(e,"editId",Un,Object(p.a)(e)),e.componentDidMount=function(){return e.props.userStore.refresh()},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.deleteId,n=this.editId,a=this.createDialog,r=this.props.userStore,i=r.getItems();return Object(ee.jsxs)(se,{title:"Users",rightControl:Object(ee.jsx)(N.a,{id:"create-user",variant:"contained",color:"primary",onClick:function(){return e.createDialog=!0},children:"Create User"}),children:[Object(ee.jsx)(ce.a,{item:!0,xs:12,children:Object(ee.jsx)(nt.a,{elevation:6,children:Object(ee.jsxs)(at.a,{id:"user-table",children:[Object(ee.jsx)(ct.a,{children:Object(ee.jsxs)(st.a,{style:{textAlign:"center"},children:[Object(ee.jsx)(it.a,{children:"Name"}),Object(ee.jsx)(it.a,{children:"Admin"}),Object(ee.jsx)(it.a,{})]})}),Object(ee.jsx)(rt.a,{children:i.map((function(t){return Object(ee.jsx)($n,{name:t.name,admin:t.admin,fDelete:function(){return e.deleteId=t.id},fEdit:function(){return e.editId=t.id}},t.id)}))})]})})}),a&&Object(ee.jsx)(Zn,{fClose:function(){return e.createDialog=!1},fOnSubmit:r.create}),!1!==n&&Object(ee.jsx)(Zn,{fClose:function(){return e.editId=!1},fOnSubmit:r.update.bind(this,n),name:r.getByID(n).name,admin:r.getByID(n).admin,isEdit:!0}),!1!==t&&Object(ee.jsx)(pt,{title:"Confirm Delete",text:"Delete "+r.getByID(t).name+"?",fClose:function(){return e.deleteId=!1},fOnSubmit:function(){return r.remove(t)}})]})}}]),n}(a.Component),En=Object(m.a)(zn.prototype,"createDialog",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wn=Object(m.a)(zn.prototype,"deleteId",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Un=Object(m.a)(zn.prototype,"editId",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Tn=zn))||Tn,ta=Object(y.a)((function(){return{wrapper:{margin:"0 auto",maxWidth:700}}}))(je("userStore")(ea)),na=function(e){var t=e.height,n=e.retry,a=e.message;return Object(ee.jsx)("div",{style:{backgroundColor:"#e74c3c",height:t,width:"100%",zIndex:1300,position:"relative"},children:Object(ee.jsxs)(B.a,{align:"center",variant:"h6",style:{lineHeight:"".concat(t,"px")},children:[a," ",Object(ee.jsx)(N.a,{variant:"outlined",onClick:n,children:"Retry"})]})})},aa="gotify-theme",ra={light:Object(x.a)({palette:{type:"light"}}),dark:Object(x.a)({palette:{type:"dark"}})},ia=Object(Q.c)((_n=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(h.a)(e,"currentTheme",qn,Object(p.a)(e)),Object(h.a)(e,"showSettings",Ln,Object(p.a)(e)),Object(h.a)(e,"navOpen",Fn,Object(p.a)(e)),e}return Object(b.a)(n,[{key:"setNavOpen",value:function(e){this.navOpen=e}},{key:"componentDidMount",value:function(){var e,t=window.localStorage.getItem(aa);"light"===(e=t)||"dark"===e?this.currentTheme=t:window.localStorage.setItem(aa,this.currentTheme)}},{key:"render",value:function(){var e=this,t=this.showSettings,n=this.currentTheme,a=this.props,r=a.classes,i=a.currentUser,c=i.loggedIn,s=i.authenticating,o=i.user,l=o.name,d=o.admin,h=i.logout,j=i.tryReconnect,b=i.connectionErrorMessage,p=ra[n],f=u("version").version;return Object(ee.jsx)(v.a,{theme:p,children:Object(ee.jsx)(C.a,{children:Object(ee.jsxs)("div",{children:[b?Object(ee.jsx)(na,{height:64,retry:function(){return j()},message:b}):null,Object(ee.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(ee.jsx)(w.a,{}),Object(ee.jsx)(re,{style:{top:b?64:0},admin:d,name:l,version:f,loggedIn:c,toggleTheme:this.toggleTheme.bind(this),showSettings:function(){return e.showSettings=!0},logout:h,setNavOpen:this.setNavOpen.bind(this)}),Object(ee.jsxs)("div",{style:{display:"flex"},children:[Object(ee.jsx)(Ue,{loggedIn:c,navOpen:this.navOpen,setNavOpen:this.setNavOpen.bind(this)}),Object(ee.jsx)("main",{className:r.content,children:Object(ee.jsxs)(k.d,{children:[s?Object(ee.jsx)(k.b,{path:"/",children:Object(ee.jsx)(oe,{})}):null,Object(ee.jsx)(k.b,{exact:!0,path:"/login",render:function(){return c?Object(ee.jsx)(k.a,{to:"/"}):Object(ee.jsx)(Nn,{})}}),c?null:Object(ee.jsx)(k.a,{to:"/login"}),Object(ee.jsx)(k.b,{exact:!0,path:"/",component:Jn}),Object(ee.jsx)(k.b,{exact:!0,path:"/messages/:id",component:Jn}),Object(ee.jsx)(k.b,{exact:!0,path:"/applications",component:Rt}),Object(ee.jsx)(k.b,{exact:!0,path:"/clients",component:Gt}),Object(ee.jsx)(k.b,{exact:!0,path:"/users",component:ta}),Object(ee.jsx)(k.b,{exact:!0,path:"/plugins",component:en}),Object(ee.jsx)(k.b,{exact:!0,path:"/plugins/:id",component:Cn})]})})]}),t&&Object(ee.jsx)(Qe,{fClose:function(){return e.showSettings=!1}}),Object(ee.jsx)(Fe,{}),Object(ee.jsx)(et,{})]})]})})})}},{key:"toggleTheme",value:function(){this.currentTheme="dark"===this.currentTheme?"light":"dark",localStorage.setItem(aa,this.currentTheme)}}]),n}(a.Component),qn=Object(m.a)(_n.prototype,"currentTheme",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"dark"}}),Ln=Object(m.a)(_n.prototype,"showSettings",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fn=Object(m.a)(_n.prototype,"navOpen",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Pn=_n))||Pn,ca=Object(y.a)((function(e){return{content:Object(g.a)({margin:"0 auto",marginTop:64,padding:e.spacing(4),width:"100%"},e.breakpoints.down("xs"),{marginTop:0})}}),{withTheme:!0})(je("currentUser","snackManager")(ia));var sa,oa,la,ua,da,ha,ja,ba,pa,fa,Oa,ma,ga,xa,va,ya,wa,ka,Ca,Sa,Ia,Na,Da,Aa,Ma,Ba,Ta,za,Ea,Wa,Ua,Pa,_a,qa,La,Fa,Ra,Ha,Ka=n(229),Va=n(230),Ya="gotify-login-key",Ga=(sa=function e(t){var n=this;Object(j.a)(this,e),this.snack=t,this.tokenCache=null,this.reconnectTimeoutId=null,this.reconnectTime=7500,Object(h.a)(this,"loggedIn",oa,this),Object(h.a)(this,"authenticating",la,this),Object(h.a)(this,"user",ua,this),Object(h.a)(this,"connectionErrorMessage",da,this),this.token=function(){if(null!==n.tokenCache)return n.tokenCache;var e=window.localStorage.getItem(Ya);return e?(n.tokenCache=e,e):""},this.setToken=function(e){n.tokenCache=e,window.localStorage.setItem(Ya,e)},this.register=function(){var e=Object(an.a)(nn.a.mark((function e(t,a){return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.create().post(u("url")+"user",{name:t,pass:a}).then((function(){return n.snack("User Created. Logging in..."),n.login(t,a),!0})).catch((function(e){var t,a;if(!e||!e.response)return n.snack("No network connection or server unavailable."),!1;var r=e.response.data;return n.snack("Register failed: ".concat(null!==(t=null===r||void 0===r?void 0:r.error)&&void 0!==t?t:"unknown",": ").concat(null!==(a=null===r||void 0===r?void 0:r.errorDescription)&&void 0!==a?a:"")),!1})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.login=function(){var e=Object(an.a)(nn.a.mark((function e(t,a){var r,i;return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.loggedIn=!1,n.authenticating=!0,r=Object(Va.a)(),i=r&&r.name+" "+r.version||"unknown browser",s.a.create().request({url:u("url")+"client",method:"POST",data:{name:i},headers:{Authorization:"Basic "+Ka.a.encode(t+":"+a)}}).then((function(e){n.snack("A client named '".concat(i,"' was created for your session.")),n.setToken(e.data.token),n.tryAuthenticate().then((function(){n.authenticating=!1,n.loggedIn=!0})).catch((function(){n.authenticating=!1,console.log("create client succeeded, but authenticated with given token failed")}))})).catch((function(){return n.authenticating=!1,n.snack("Login failed")}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.tryAuthenticate=Object(an.a)(nn.a.mark((function e(){return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n.token()){e.next=2;break}return e.abrupt("return",Promise.reject());case 2:return e.abrupt("return",s.a.create().get(u("url")+"current/user",{headers:{"X-Gotify-Key":n.token()}}).then((function(e){return n.user=e.data,n.loggedIn=!0,n.connectionErrorMessage=null,n.reconnectTime=7500,e})).catch((function(e){return e&&e.response?e.response.status>=500?(n.connectionError("".concat(e.response.statusText," (code: ").concat(e.response.status,").")),Promise.reject(e)):(n.connectionErrorMessage=null,e.response.status>=400&&e.response.status<500&&n.logout(),Promise.reject(e)):(n.connectionError("No network connection or server unavailable."),Promise.reject(e))})));case 3:case"end":return e.stop()}}),e)}))),this.logout=Object(an.a)(nn.a.mark((function e(){return nn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get(u("url")+"client").then((function(e){e.data.filter((function(e){return e.token===n.tokenCache})).forEach((function(e){return s.a.delete(u("url")+"client/"+e.id)}))})).catch((function(){return Promise.resolve()}));case 2:window.localStorage.removeItem(Ya),n.tokenCache=null,n.loggedIn=!1;case 5:case"end":return e.stop()}}),e)}))),this.changePassword=function(e){s.a.post(u("url")+"current/user/password",{pass:e}).then((function(){return n.snack("Password changed")}))},this.tryReconnect=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.tryAuthenticate().catch((function(){e||n.snack("Reconnect failed")}))},this.connectionError=function(e){n.connectionErrorMessage=e,null!==n.reconnectTimeoutId&&window.clearTimeout(n.reconnectTimeoutId),n.reconnectTimeoutId=window.setTimeout((function(){return n.tryReconnect(!0)}),n.reconnectTime),n.reconnectTime=Math.min(2*n.reconnectTime,12e4)}},oa=Object(m.a)(sa.prototype,"loggedIn",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),la=Object(m.a)(sa.prototype,"authenticating",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ua=Object(m.a)(sa.prototype,"user",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{name:"unknown",admin:!1,id:-1}}}),da=Object(m.a)(sa.prototype,"connectionErrorMessage",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sa),Xa=(ha=function e(){var t=this;Object(j.a)(this,e),Object(h.a)(this,"items",ja,this),Object(h.a)(this,"remove",ba,this),Object(h.a)(this,"refresh",pa,this),this.getByID=function(e){var n=t.getByIDOrUndefined(e);if(void 0===n)throw new Error("cannot find item with id "+e);return n},this.getByIDOrUndefined=function(e){return t.items.find((function(t){return t.id===e}))},this.getItems=function(){return t.items},Object(h.a)(this,"clear",fa,this)},ja=Object(m.a)(ha.prototype,"items",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ba=Object(m.a)(ha.prototype,"remove",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.requestDelete(n);case 2:return t.next=4,e.refresh();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),pa=Object(m.a)(ha.prototype,"refresh",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Object(an.a)(nn.a.mark((function t(){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.requestItems().then((function(e){return e||[]}));case 2:e.items=t.sent;case 3:case"end":return t.stop()}}),t)})))}}),fa=Object(m.a)(ha.prototype,"clear",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.items=[]}}}),ha),Ja=(Oa=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this)).snack=e,a.onDelete=function(){},a.requestItems=function(){return s.a.get("".concat(u("url"),"application")).then((function(e){return e.data}))},a.requestDelete=function(e){return s.a.delete("".concat(u("url"),"application/").concat(e)).then((function(){return a.onDelete(),a.snack("Application deleted")}))},Object(h.a)(a,"uploadImage",ma,Object(p.a)(a)),Object(h.a)(a,"update",ga,Object(p.a)(a)),Object(h.a)(a,"create",xa,Object(p.a)(a)),a.getName=function(e){var t=a.getByIDOrUndefined(e);return-1===e?"All Messages":void 0!==t?t.name:"unknown"},a}return n}(Xa),ma=Object(m.a)(Oa.prototype,"uploadImage",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a){var r;return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new FormData).append("file",a),t.next=4,s.a.post("".concat(u("url"),"application/").concat(n,"/image"),r,{headers:{"content-type":"multipart/form-data"}});case 4:return t.next=6,e.refresh();case 6:e.snack("Application image updated");case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),ga=Object(m.a)(Oa.prototype,"update",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a,r){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.put("".concat(u("url"),"application/").concat(n),{name:a,description:r});case 2:return t.next=4,e.refresh();case 4:e.snack("Application updated");case 5:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()}}),xa=Object(m.a)(Oa.prototype,"create",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.post("".concat(u("url"),"application"),{name:n,description:a});case 2:return t.next=4,e.refresh();case 4:e.snack("Application created");case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),Oa),Qa=function e(t,n){var a=this;Object(j.a)(this,e),this.snack=t,this.currentUser=n,this.wsActive=!1,this.ws=null,this.listen=function(e){if(a.currentUser.token()&&!a.wsActive){a.wsActive=!0;var t=u("url").replace("http","ws").replace("https","wss"),n=new WebSocket(t+"stream?token="+a.currentUser.token());n.onerror=function(e){a.wsActive=!1,console.log("WebSocket connection errored",e)},n.onmessage=function(t){return e(JSON.parse(t.data))},n.onclose=function(){a.wsActive=!1,a.currentUser.tryAuthenticate().then((function(){a.snack("WebSocket connection closed, trying again in 30 seconds."),setTimeout((function(){return a.listen(e)}),3e4)})).catch((function(e){var t;401===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)&&a.snack("Could not authenticate with client token, logging out.")}))},a.ws=n}},this.close=function(){var e;return null===(e=a.ws)||void 0===e?void 0:e.close(1e3,"WebSocketStore#close")}},Za=(va=function e(){var t=this;Object(j.a)(this,e),Object(h.a)(this,"messages",ya,this),Object(h.a)(this,"message",wa,this),Object(h.a)(this,"counter",ka,this),Object(h.a)(this,"next",Ca,this),this.hasNext=function(){return t.messages.length>0},Object(h.a)(this,"snack",Sa,this)},ya=Object(m.a)(va.prototype,"messages",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),wa=Object(m.a)(va.prototype,"message",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ka=Object(m.a)(va.prototype,"counter",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ca=Object(m.a)(va.prototype,"next",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){if(!e.hasNext())throw new Error("There is nothing here :(");e.message=e.messages.shift()}}}),Sa=Object(m.a)(va.prototype,"snack",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.messages.push(t),e.counter++}}}),va),$a=(Ia=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this)).snack=e,a.requestItems=function(){return s.a.get("".concat(u("url"),"user")).then((function(e){return e.data}))},Object(h.a)(a,"create",Na,Object(p.a)(a)),Object(h.a)(a,"update",Da,Object(p.a)(a)),a}return Object(b.a)(n,[{key:"requestDelete",value:function(e){var t=this;return s.a.delete("".concat(u("url"),"user/").concat(e)).then((function(){return t.snack("User deleted")}))}}]),n}(Xa),Na=Object(m.a)(Ia.prototype,"create",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a,r){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.post("".concat(u("url"),"user"),{name:n,pass:a,admin:r});case 2:return t.next=4,e.refresh();case 4:e.snack("User created");case 5:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()}}),Da=Object(m.a)(Ia.prototype,"update",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a,r,i){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.post(u("url")+"user/"+n,{name:a,pass:r,admin:i});case 2:return t.next=4,e.refresh();case 4:e.snack("User updated");case 5:case"end":return t.stop()}}),t)})));return function(e,n,a,r){return t.apply(this,arguments)}}()}}),Ia),er=n(94),tr=n(143),nr=-1,ar=(Aa=function(){function e(t,n){var a=this;Object(j.a)(this,e),this.appStore=t,this.snack=n,Object(h.a)(this,"state",Ma,this),this.loading=!1,this.stateOf=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!a.state[e]&&t&&(a.state[e]=a.emptyState()),a.state[e]||a.emptyState()},this.canLoadMore=function(e){return a.stateOf(e,!1).hasMore},Object(h.a)(this,"loadMore",Ba,this),Object(h.a)(this,"publishSingleMessage",Ta,this),Object(h.a)(this,"removeByApp",za,this),Object(h.a)(this,"removeSingle",Ea,this),Object(h.a)(this,"clearAll",Wa,this),Object(h.a)(this,"refreshByApp",Ua,this),this.exists=function(e){return a.stateOf(e).loaded},this.clear=function(e){return a.state[e]=a.emptyState()},this.fetchMessages=function(e,t){return e===nr?s.a.get(u("url")+"message?since="+t):s.a.get(u("url")+"application/"+e+"/message?since="+t)},this.getUnCached=function(e){var t=a.appStore.getItems().reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(g.a)({},t.id,t.image))}),{});return a.stateOf(e,!1).messages.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{image:t[e.appid]||null})}))},this.get=Object(tr.a)(this.getUnCached),this.clearCache=function(){return a.get=Object(tr.a)(a.getUnCached)},this.createEmptyStatesForApps=function(e){e.map((function(e){return e.id})).forEach((function(e){return a.stateOf(e,!0)})),a.clearCache()},this.emptyState=function(){return{messages:Xe.B.array(),hasMore:!0,nextSince:0,loaded:!1}},Object(Xe.E)((function(){return t.getItems()}),this.createEmptyStatesForApps)}return Object(b.a)(e,[{key:"removeFromList",value:function(e,t){if(e){var n=e.findIndex((function(e){return e.id===t.id}));if(-1!==n)return e.splice(n,1),n}return!1}}]),e}(),Ma=Object(m.a)(Aa.prototype,"state",[Xe.B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ba=Object(m.a)(Aa.prototype,"loadMore",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){var a,r,i;return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=e.stateOf(n)).hasMore&&!e.loading){t.next=3;break}return t.abrupt("return",Promise.resolve());case 3:return e.loading=!0,t.next=6,e.fetchMessages(n,r.nextSince).then((function(e){return e.data}));case 6:return i=t.sent,r.messages.replace([].concat(Object(er.a)(r.messages),Object(er.a)(i.messages))),r.nextSince=null!==(a=i.paging.since)&&void 0!==a?a:0,r.hasMore="next"in i.paging,r.loaded=!0,e.loading=!1,t.abrupt("return",Promise.resolve());case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Ta=Object(m.a)(Aa.prototype,"publishSingleMessage",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.exists(nr)&&e.stateOf(nr).messages.unshift(t),e.exists(t.appid)&&e.stateOf(t.appid).messages.unshift(t)}}}),za=Object(m.a)(Aa.prototype,"removeByApp",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n!==nr){t.next=7;break}return t.next=3,s.a.delete(u("url")+"message");case 3:e.snack("Deleted all messages"),e.clearAll(),t.next=12;break;case 7:return t.next=9,s.a.delete(u("url")+"application/"+n+"/message");case 9:e.snack("Deleted all messages from ".concat(e.appStore.getByID(n).name)),e.clear(nr),e.clear(n);case 12:return t.next=14,e.loadMore(n);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Ea=Object(m.a)(Aa.prototype,"removeSingle",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.delete(u("url")+"message/"+n.id);case 2:e.exists(nr)&&e.removeFromList(e.state[-1].messages,n),e.exists(n.appid)&&e.removeFromList(e.state[n.appid].messages,n),e.snack("Message deleted");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Wa=Object(m.a)(Aa.prototype,"clearAll",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.state={},e.createEmptyStatesForApps(e.appStore.getItems())}}}),Ua=Object(m.a)(Aa.prototype,"refreshByApp",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.clearAll(),e.loadMore(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Aa),rr=(Pa=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this)).snack=e,a.requestItems=function(){return s.a.get("".concat(u("url"),"client")).then((function(e){return e.data}))},Object(h.a)(a,"update",_a,Object(p.a)(a)),Object(h.a)(a,"createNoNotifcation",qa,Object(p.a)(a)),Object(h.a)(a,"create",La,Object(p.a)(a)),a}return Object(b.a)(n,[{key:"requestDelete",value:function(e){var t=this;return s.a.delete("".concat(u("url"),"client/").concat(e)).then((function(){return t.snack("Client deleted")}))}}]),n}(Xa),_a=Object(m.a)(Pa.prototype,"update",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.put("".concat(u("url"),"client/").concat(n),{name:a});case 2:return t.next=4,e.refresh();case 4:e.snack("Client updated");case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),qa=Object(m.a)(Pa.prototype,"createNoNotifcation",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){var a;return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.post("".concat(u("url"),"client"),{name:n});case 2:return a=t.sent,t.next=5,e.refresh();case 5:return t.abrupt("return",a.data);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),La=Object(m.a)(Pa.prototype,"create",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createNoNotifcation(n);case 2:e.snack("Client added");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Pa),ir=(Fa=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(j.a)(this,n),(a=t.call(this)).snack=e,a.onDelete=function(){},a.requestConfig=function(e){return s.a.get("".concat(u("url"),"plugin/").concat(e,"/config")).then((function(e){return e.data}))},a.requestDisplay=function(e){return s.a.get("".concat(u("url"),"plugin/").concat(e,"/display")).then((function(e){return e.data}))},a.requestItems=function(){return s.a.get("".concat(u("url"),"plugin")).then((function(e){return e.data}))},a.requestDelete=function(){throw a.snack("Cannot delete plugin"),new Error("Cannot delete plugin")},a.getName=function(e){var t=a.getByIDOrUndefined(e);return-1===e?"All Plugins":void 0!==t?t.name:"unknown"},Object(h.a)(a,"changeConfig",Ra,Object(p.a)(a)),Object(h.a)(a,"changeEnabledState",Ha,Object(p.a)(a)),a}return n}(Xa),Ra=Object(m.a)(Fa.prototype,"changeConfig",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.post("".concat(u("url"),"plugin/").concat(n,"/config"),a,{headers:{"content-type":"application/x-yaml"}});case 2:return e.snack("Plugin config updated"),t.next=5,e.refresh();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),Ha=Object(m.a)(Fa.prototype,"changeEnabledState",[Xe.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(an.a)(nn.a.mark((function t(n,a){return nn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.post("".concat(u("url"),"plugin/").concat(n,"/").concat(a?"enable":"disable"));case 2:return e.snack("Plugin ".concat(a?"enabled":"disabled")),t.next=5,e.refresh();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),Fa),cr=function(e){var t=function(){e.messagesStore.clearAll(),e.appStore.clear(),e.clientStore.clear(),e.userStore.clear(),e.wsStore.close()},n=function(){e.wsStore.listen((function(t){var n;if(e.messagesStore.publishSingleMessage(t),n=t,new fe.a(n.title,{body:me()(n.message),icon:n.image,silent:!0,notifyClick:xe,notifyShow:ve}).show(),t.priority>=4){new Audio("static/notification.ogg").play()}})),e.appStore.refresh()};Object(Xe.E)((function(){return e.currentUser.loggedIn}),(function(e){e?n():t()})),Object(Xe.E)((function(){return e.currentUser.connectionErrorMessage}),(function(e){e||(t(),n())}))},sr=window.location,or=sr.port,lr=sr.hostname,ur=sr.protocol,dr=sr.pathname,hr=ur.concat("//"),jr=dr.endsWith("/")?dr:dr.substring(0,dr.lastIndexOf("/")),br=hr.concat(or?lr.concat(":",or):lr)+jr,pr=br.endsWith("/")?br:br.concat("/");!function(){var e;e=pr,l["url"]=e;var t,n,a=function(){var e=new Za,t=new Ja(e.snack),n=new $a(e.snack),a=new ar(t,e.snack),r=new Ga(e.snack),i=new rr(e.snack),c=new Qa(e.snack,r),s=new ir(e.snack);return t.onDelete=function(){return a.clearAll()},{appStore:t,snackManager:e,userStore:n,messagesStore:a,currentUser:r,clientStore:i,wsStore:c,pluginStore:s}}();t=a.currentUser,n=a.snackManager.snack,s.a.interceptors.request.use((function(e){return e.headers["X-Gotify-Key"]=t.token(),e})),s.a.interceptors.response.use(void 0,(function(e){if(!e.response)return n("Gotify server is not reachable, try refreshing the page."),Promise.reject(e);var a=e.response.status;return 401===a&&t.tryAuthenticate().then((function(){return n("Could not complete request.")})),400!==a&&403!==a&&500!==a||n(e.response.data.error+": "+e.response.data.errorDescription),Promise.reject(e)})),cr(a),a.currentUser.tryAuthenticate().catch((function(){})),window.onbeforeunload=function(){a.wsStore.close()},i.render(Object(ee.jsx)(be,{stores:a,children:Object(ee.jsx)(ca,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}()}},[[421,1,2]]]);
//# sourceMappingURL=main.ac0b82e7.chunk.js.map